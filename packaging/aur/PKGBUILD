# Maintainer: Valentin Radu
#
# Package name is "halt". If that is taken on AUR, use "halt-sandbox".
pkgname=halt
pkgver=0.0.1
pkgrel=1
pkgdesc="Wrap any process in a filesystem and network sandbox"
arch=('x86_64' 'aarch64')
url="https://github.com/valentinradu/Halt"
license=('MIT')
depends=()
makedepends=('cargo')
source=("$pkgname-$pkgver.tar.gz::https://github.com/valentinradu/Halt/archive/refs/tags/v$pkgver.tar.gz")
sha256sums=('PLACEHOLDER_SOURCE_SHA256')

prepare() {
    cd "Halt-$pkgver"
    cargo fetch --locked --target "$CARCH-unknown-linux-gnu"
}

build() {
    cd "Halt-$pkgver"
    cargo build --release --locked -p halt
}

check() {
    cd "Halt-$pkgver"
    cargo test --release --locked -p halt
}

package() {
    cd "Halt-$pkgver"
    install -Dm755 target/release/halt "$pkgdir/usr/bin/halt"
    install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
